<html><head><title>Everyone's Sky</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1.01"><style>#t{display:table}#c{display:table-cell;vertical-align:middle}#cc{margin:auto;outline:#fff solid 1px}#t,body,canvas,html{width:100%;height:100%;background-color:#000;margin:0;-webkit-touch-callout:none;user-select:none;-webkit-user-select:none}canvas{display:block;cursor:none}</style></head><body><div id="t"><div id="c"><div id="cc" style="width: 993px; height: 993px;"><canvas width="1000" height="1000"></canvas></div></div></div><script>let R,G,V,U,dh,aE,w=window,fB=navigator.userAgent.match(/andro|ipho|ipa|ipo|windows ph/i),__=fB?1400:1e3;_x=((t,s,i)=>s<t?t:s>i?i:s),_g=((t,s,i)=>s>=t&&s<=i),C=((t,s)=>random()*(s-t)+t),_$=(t=>t[~~(random()*t.length)]),bS=((t,s,i,h)=>sqrt(pow(t-i,2)+pow(s-h,2))),H=((t,s)=>bS(t.x,t.y,s.x,s.y)),aR=(t=>t<0?-1:t>0?1:0),dg=((t,s)=>((t%=2*s)>s&&(t-=2*s),t<-s&&(t+=2*s),t)),aT=(t=>dg(t,PI)),_P=((t,s)=>atan2(s.y-t.y,s.x-t.x));let m=Math;Object.getOwnPropertyNames(m).forEach(t=>w[t]=w[t]||m[t]);let p=CanvasRenderingContext2D.prototype;p.M=function(t){this.save(),t(),this.restore()},p.fr=p.fillRect,p.K=function(t){this.fillStyle=t},_y=(t=>{let s,i=[],h=0;t.toLowerCase().split("").forEach(t=>{let e=hR[t]||[],a=h;e.forEach(t=>{i.push([h+t[0],t[1],h+t[2],t[3]]),a=max(a,h+t[0]+.4,h+t[2]+.4)}),e.length||(a+=1),s=(h=a)-.4});let e=[],a=0;for(let t=0;t<i.length;t++)e.splice(~~(random()*e.length),0,a),a+=1;return{ay:i,bw:e,width:s,height:1}}),be=((t,s,i,h,e,a)=>{t.ay.forEach((r,_)=>{M(()=>{let l=t.bw[_],n=_x(0,(h-l*e)/a,1),o=aR((_+l)%2-.5);_%2-.5>0?translate(o*(1-n)*50,0):translate(0,o*(1-n)*50),R.globalAlpha*=n,beginPath(),moveTo(r[0]*s,r[1]*i),lineTo(r[2]*s,r[3]*i),stroke()})})});let _d=[0,0,0,1],ai=[1,0,1,1],_R=[0,0,1,0],_I=[0,1,1,1],b$=[0,.5,1,.5],cY=[1,.5,1,1],hR={a:[[0,1,.5,0],[1,1,.5,0]],b:[_d,_I,b$,cY,[0,0,.75,0],[.75,0,.75,.5]],c:[_d,_R,_I],d:[_d,[0,0,1,.5],[1,.5,0,1]],e:[_d,_R,[0,.5,2/3,.5],_I],f:[_d,_R,[0,.5,2/3,.5]],g:[_R,_d,_I,cY],h:[_d,ai,b$],i:[_d],j:[ai,_I,[0,.5,0,1]],k:[_d,[1,0,0,.5],[1,1,0,.5]],l:[_d,_I],m:[_d,[0,0,.5,.5],[1,0,.5,.5],ai],n:[_d,[0,0,1,1],ai],o:[_R,_I,_d,ai],p:[_d,_R,[1,0,1,.5],b$],q:[_R,_I,_d,ai,[1,1,1,1.3]],r:[_d,_R,[1,0,1,.5],b$,[0,.5,1,1]],s:[_R,[0,0,0,.5],b$,cY,_I],t:[_R,[.5,0,.5,1]],u:[_d,_I,ai],v:[[0,0,.5,1],[1,0,.5,1]],w:[[0,0,.25,1],[.25,1,.5,.5],[.75,1,.5,.5],[1,0,.75,1]],x:[[0,0,1,1],[1,0,0,1]],y:[[0,0,.5,.5],[.5,.5,1,0],[.5,.5,.5,1]],z:[_R,_I,[1,0,0,1]],"'":[[0,.25,.25,0]],"-":[[0,.5,1,.5]]},bd=(t,s,i)=>{let h=document.createElement("canvas");return h.width=t,h.height=s,i(h.getContext("2d"),h),h};eM=(()=>{beginPath(),arc(0,-12,15,0,2*PI),fill(),beginPath(),arc(12,12,15,0,2*PI),fill(),beginPath(),arc(-12,12,15,0,2*PI),fill()}),eG=((t,s,i,h)=>bd(t.width+2*s,t.height+2*s,(e,a)=>{let r=e.createRadialGradient(a.width/2,a.height/2,t.width/2,a.width/2,a.height/2,t.width/2+s);r.addColorStop(0,i),r.addColorStop(1,h),e.K(r),e.fr(0,0,a.width,a.height);try{e.drawImage(t,s,s)}catch(t){}})),_C=((t,s,i)=>{let h;U.cP.push(h={aO:t,dW:1,_e:()=>M(()=>{if(i)return i(h);V._G(h.x,h.y,h.hs)&&(R.globalAlpha=h.dW,K(h.aO),beginPath(),arc(h.x,h.y,h.hs/2,0,2*PI),fill())})}),s.forEach((t,s)=>{let i=[h].concat(t);s||(i[7]=(()=>U._E(U.cP,h))),_f.apply(0,i)})});class ad{constructor(){this._W=[]}W(){}hm(){this._W.forEach(t=>G.aK.hk(t._J,t._F)),this._W=[]}_p(t,s){this._W.push({_J:t,_F:s}),G.aK._p(t,s)}aP(){this.W()}_q(t){this.hh(t)}}class hg extends ad{W(){V.cL=1,G._n("Follow a quick tutorial?",[{hN:"Yes",i$:()=>this._q(new he)},{hN:"No",i$:()=>this._q(new eW)}])}}class he extends ad{W(){G._n("Use arrow keys to control your ship");let t={x:U.D.x,y:U.D.y};this._p(1,()=>{H(t,U.D)>500&&this._q(new hd)})}}class hd extends ad{W(){G._n("Press [SPACE] for blasters, [ENTER] for torpedoes");let t=20;this._p(2,s=>{s._K!==U.D||--t||this._q(new hb)})}}class hb extends ad{W(){G._n("Communications are OFFLINE. Find resources to repair them",[{hN:"Help",i$:()=>G._n("Resources can be collected by destroying asteroids")}]),this._p(1,()=>{U.D.B._A>=20&&this._q(new h_)}),this._p(1,()=>{U._a.length<10&&U.eD()})}}class h_ extends ad{W(){G._n("Communications are ONLINE. Good job"),setTimeout(()=>this._q(new eW),5e3)}}class eW extends ad{W(){V.cL=0,U.gZ(),G._n("Bring PEACE to the galaxy, or WAR... your call",[{hN:"Dismiss",i$:()=>this._q()}]),G.cB=0}}class gX extends ad{constructor(t){super(),this.O=t}W(){super.W();let t=15;this._p(1,s=>{(t-=s)<0&&this._q()}),G._n(()=>"Incoming communication from "+this.O.B.J.dT()+" - "+cv(t),[{hN:"Respond",i$:()=>{t=15,G._n(()=>this.O._M+" - "+cv(t),[{hN:"Accept",i$:()=>this._q(this.O)},{hN:"Refuse",i$:()=>this._q()}])}},{hN:"Ignore",i$:()=>this._q()}])}_q(t){super._q(t),t||(this.O.B.aF(-.1),G._n("Communication ignored. "+this.O.B.J._u+" will remember that",[{hN:"Dismiss",i$:()=>G._n()}]),setTimeout(()=>G._n(),3e3))}}class aG extends ad{W(){this.aa=120,this._p(1,t=>{(this.aa-=t)<0&&G.bl(0)}),G._n(()=>this.af()+" - "+cv(this.aa))}ee(t,s){let i=new gR(t,s);i.B=this.B,this._q(i),i.aa=this.aa}}class hX extends aG{constructor(t){super(),this.I=t,this._M="Destroy facilities on "+t.dT(),this._v=[t],this.gN=min(this.I.ak.length,~~C(3,5))}af(){return"Destroy "+this.gN+" facilities on "+this.I._u}W(){super.W(),this._p(0,t=>{t.I!==this.I||--this.gN||G.bl(1)})}}class gL extends aG{constructor(t){super(),this.F=t,this._M="Collect some data on "+t.dT()+" for us",this._v=[t],this.dH=0}af(){return this.dF()?"Collecting data... - "+~~(100*this.dH)+"%":"Get close to "+this.F._u}W(){super.W(),this._p(1,t=>{this.dF()&&(this.dH+=.025*t,this.dH>=1&&this.ee(this.B.J,"Return to "+this.B.J._u))})}dF(){return H(U.D,this.F)<4*this.F.$}}class gJ extends aG{constructor(){super(),this._M="We need resources, please collect some for us",this.bb=100,this.gI=0}af(){return"Collect resources - "+this.gI+"/"+this.bb}W(){super.W(),this._p(3,()=>{U.D.B._A--,++this.gI>=this.bb&&this.ee(this.B.J,"Return to "+this.B.J._u)})}}class gH extends aG{constructor(){super(),this._M="Destroy these asteroids for us"}af(){return"Destroy the asteroids"}W(){super.W();let t=[];for(let s=0;s<5;s++){let s=new cs;s.x=this.B.J.x+2e3*_$([-1,1]),s.y=this.B.J.y+C(-2500,2500),s._r=aR(this.B.J.x-s.x)*min(abs(s._r),100),s._o=aR(this.B.J.y-s.y)*min(abs(s._o),100),s.gF=1,U._a.push(s),t.push(s)}this._p(1,()=>{this._v=t.filter(t=>t._m>0),this._v.length||G.bl(1)})}}class gD extends aG{constructor(){super(),this._M="Help us fight these pirates"}af(){return"Destroy the pirate ships"}W(){super.W();let t=U.fp(this.B.J._z.x+_$([-1,1])*(this.B.J._z.ac+800),this.B.J.y+C(-5e3,5e3));this._p(1,()=>{this._v=t.filter(t=>t._m>0),this._v.length||G.bl(1)})}}class gR extends aG{constructor(t,s){super(),this._v=[t],this._M=s}af(){return this._M}W(){super.W(),this._p(1,()=>{H(this._v[0],U.D)<3*this._v[0].$&&G.bl(1)})}}class gB{constructor(){this._k=[],this._a=[],this.aA=[],this.cP=[],this.aC=[],this.aN=[],this.aL=[],this.J={x:0,y:0},this.bV=createRadialGradient(0,0,0,0,0,1),this.bV.addColorStop(0,"rgba(255,255,200,1)"),this.bV.addColorStop(.3,"rgba(255,255,200,0.1)"),this.bV.addColorStop(1,"rgba(255,255,200,0)"),this.fe(),this.fd=0}fe(){this._E(this._k,this.D),this._k.push(this.D=new gy(this.J.x,this.J.y))}S(t){(this.fd-=t)<=0&&(this.fd=this.aA.filter(t=>H(t,U.D)<t.ac).length?5:2,this.eD()),this.forEach([this._a,this._k,this.aN,this.aC,[V]],s=>s.S(t))}eD(){let t=new cs;t.x=U.D.x+_$([-1.1,1.1])*V.width/2,t.y=U.D.y+_$([-1.1,1.1])*V.height/2,U._a.push(t)}forEach(t,s){t.forEach(t=>t.forEach(t=>s(t)))}_e(){K("#000"),fr(0,0,1e3,__);let t=bt(1);M(()=>{translate(500,__/2),scale(V.ab,V.ab),K(this.bV);for(let s=0;s<400;s++)M(()=>{let s=t._g(.1,.3);translate(dg(1e3*t._g(-1,1)-U.D.x*s,1e3),dg(t._g(-1,1)*__-U.D.y*s,__)),scale(20*s,20*s),beginPath(),arc(0,0,1,0,2*PI),fill()})}),M(()=>{scale(V.ab,V.ab),translate(-V.x,-V.y),this.forEach([this.aC,this.cP,this._k,this._a,this.aN],t=>M(()=>{t._e()})),R.shadowColor="#000",R.shadowOffsetY=4,this._a.filter(t=>t._u&&H(t,U.D)<V.width/2).forEach(t=>M(()=>{let s=cos(-PI/4)*(t.$+20),i=sin(-PI/4)*(t.$+20),h=cos(-PI/4)*(t.$+50),e=sin(-PI/4)*(t.$+50),a=h+30,r=e;K("#fff"),R.strokeStyle=R.fillStyle,R.gq=2,beginPath(),moveTo(t.x+s,t.y+i),lineTo(t.x+h,t.y+e),lineTo(t.x+a,t.y+r),stroke(),R.gq=8,translate(t.x+a+10,t.y+r-7),be(t._y,10,15,1,0,0)}))})}_E(t,s){let i=t.indexOf(s);i>=0&&t.splice(i,1)}gn(t){this.forEach([this._k,this._a],t),this._a.forEach(s=>(s.ak||[]).forEach(t))}gZ(){this.J={x:U.D.x,y:U.D.y};let t=bt(1);for(let s=0;s<4;s++){let i=6800*s,h=t._g(0,2*PI),e=~~(2*PI*i/6800);for(let s=0;s<e;s++){let a=s/e*PI*2,r=new eH(t);r.x=cos(a+h)*i+U.D.x,r.y=sin(a+h)*i+U.D.y,this._a.push(r),this.aA.push(r);let _=t._g(2,4),l=t._g(500,700);for(let s=0;s<_;s++){let s=new gi(r,l,999*t.gh());this._a.push(s),r.ac=l+s.$,l+=t._g(500,700)}let n=t._g(0,2*PI);this.fp(cos(n)*(i+3400),sin(n)*(i+3400))}}}fp(t,s){let i=new ca({x:t,y:s,$:300},0),h=[];for(let e=0;e<C(5,8);e++)h.push(new eA(i,t+C(-300,300),s+C(-300,300)));return this._k=this._k.concat(h),this.aL=this.aL.concat(h),h}cb(t,s,i){for(let h=0;h<i;h++)U.aN.push(new ge(t,s))}}class cf{constructor(){this.x=this.y=0,this.$=0}S(){U._k.forEach(t=>{let s=this.$+t.$,i=s-H(t,this);if(i>0){let h=_P(this,t);t.x=this.x+cos(h)*(s+5),t.y=this.y+sin(h)*(s+5),t._r+=cos(h)*(i+100),t._o+=sin(h)*(i+100),_f(t,"fE",_$([-6,6]),0,1),t._s(this,.1),V._G(t.x,t.y)&&ck()}})}_s(t){_C(this.cq(),[["dW",1,0,1],["hs",C(2,4),C(5,10),1],["x",t.x,t.x+C(-20,20),1],["y",t.y,t.y+C(-20,20),1]])}}let er=[.1,.3,.2,.5];class eH extends cf{constructor(t){super(),this.$=t._g(100,200),this._u=eq(t),this._y=_y(this._u),this.cr=eG(bd(2*this.$,2*this.$,()=>0),100,"rgba(255,0,0,0.3)","rgba(255,0,0,0)"),this._B=createRadialGradient(0,0,0,0,0,this.$),this._B.addColorStop(0,"#fff"),this._B.addColorStop(.3,"#ff0"),this._B.addColorStop(1,"#f80"),this.cq=(()=>"#ff0")}_e(){if(V._G(this.x,this.y,this.$+100)){0,drawImage(this.cr,this.x-this.cr.width/2,this.y-this.cr.height/2),translate(this.x,this.y),K(this._B),beginPath();for(let t=0;t<40;t++){let s=t/40*PI*2,i=sin(Date.now()/1e3*2*PI*2+t*er[t%er.length])*this.$*.02+.98*this.$;R[t?"lineTo":"moveTo"](cos(s)*i,sin(s)*i)}fill()}}dT(){return this._u+"(star)"}}class cs extends cf{constructor(t,s){super(),this.$=t||C(25,50),this.ac=5*this.$,this._m=this.$/25,this.em=0,this.cq=(()=>_$(["#aaa","#fff","#ccc"])),s=s||C(100,200);let i=random()*PI*2;this._r=cos(i)*s,this._o=sin(i)*s,this.cw=C(PI/2,PI/4)*_$([-1,1]),this._w=bd(2*this.$,2*this.$,t=>{t.K("#aaa"),t.translate(this.$,this.$),t.beginPath();for(let s=0;s<40;s++){let i=s/40*PI*2,h=C(.75*this.$,this.$);t[s?"lineTo":"moveTo"](cos(i)*h,sin(i)*h)}t.fill(),t.globalCompositeOperation="destination-out",t.K("#000"),t.lineWidth=2;for(let s=0;s<10;s++){let s=C(0,2*PI),i=C(0,1.5*this.$);t.beginPath(),t.arc(cos(s)*i,sin(s)*i,C(2*this.$/25,5*this.$/25),0,2*PI,0),t.fill()}})}get _Y(){return bS(0,0,this._r,this._o)}S(t){super.S(t),this.x+=this._r*t,this.y+=this._o*t,this.em+=this.cw*t,U._a.forEach(t=>{if(t===this)return;let s=this.$+t.$,i=s-H(t,this);if(i>0){let h=_P(t,this);this.x=t.x+cos(h)*s,this.y=t.y+sin(h)*s,this._r+=cos(h)*(i+100),this._o+=sin(h)*(i+100)}}),V._G(this.x,this.y,V.width)||this.gF||U._E(U._a,this)}_e(){V._G(this.x,this.y,this.$)&&(translate(this.x,this.y),rotate(this.em),drawImage(this._w,-this._w.width/2,-this._w.height/2))}_s(t,s){super._s(t),this.aB=G.N,(this._m-=s)<=0&&this._Z()}_Z(){U.cb(this.x,this.y,.5*this.$);for(let t=0;t<50;t++){let t=random()*PI*2,s=random()*this.$;_C(_$(["#aaa","#fff","#ccc"]),[["dW",1,0,1],["hs",C(2,4),C(5,10),1],["x",this.x+cos(t)*s,this.x+cos(t)*s+C(-20,20),1],["y",this.y+sin(t)*s,this.y+sin(t)*s+C(-20,20),1]])}if(U._E(U._a,this),this.$>20)for(let t=0;t<2;t++){let t=new cs(this.$/2,this._Y/4);t.x=this.x+C(-this.$,this.$),t.y=this.y+C(-this.$,this.$),U._a.push(t)}ck()}}class gi extends cf{constructor(t,s,i){super(),this.L=bt(i),this.$=~~this.L._g(100,200),this.ac=4*this.$,this.B=new ca(this,this.L._g(0,.7)),this._u=eq(this.L),this._y=_y(this._u),this.cw=this.L._g(PI/8,PI/12),this.cq=(()=>"#fff"),this._z=t,this.bI=this.L._g(0,2*PI),this._N=s,this.ec=this.L.gh()<.3,this.ak=[],this.A=0,this.eb();let h=this.B._A=C(50,150);for(let t=0;t<h/10;t++)this.e_();this._w=cI(()=>eG(bd(2*this.$,2*this.$,t=>{t.K("#fff"),t.arc(this.$,this.$,this.$,0,2*PI),t.fill(),t.globalCompositeOperation="source-atop";let s=bt(this._u.charCodeAt(0)+this.$),i=[...Array(3)].map(()=>s._g(32,255));for(let h=0;h<2*this.$;h+=s._g(10,20))t.K("rgb("+i[0]+","+i[1]+","+i[2]+")"),t.fillRect(0,h,2*this.$,2*this.$),i=i.map(t=>~~_x(32,t+s._g(-20,20),255))}),50,"rgba(255,255,255,0.1)","rgba(255,255,255,0)")),this.dY=cI(()=>bd(4*this.$,2*this.$,(t,s)=>{let i=t.createLinearGradient(0,0,s.width,0);i.addColorStop(0,"#000"),i.addColorStop(1,"rgba(0,0,0,0)"),t.K(i),t.globalAlpha=.4,t.beginPath(),t.M(()=>{t.translate(0,this.$),t.scale(.7,1),t.arc(0,0,this.$,-PI/2,PI/2)}),t.lineTo(s.width,s.height),t.lineTo(s.width,0),t.fill()}))}eb(){this.x=this._z.x+cos(this.bI)*this._N,this.y=this._z.y+sin(this.bI)*this._N}S(t){super.S(t);let s=2*PI*this._N/25,i=2*PI/s;this.bI+=t*i,this.eb(),this.A+=this.cw*t,this.ak.forEach(s=>s.S(t)),this.B._A=min(200,this.B._A+.2*t),(this.fT-=t)<0&&this.e_()}e_(){this.B._A>=10&&(this.B._A-=10,_$([()=>this.cM(fR),()=>this.cM(fQ),()=>this.cM(fP),()=>this.fO()])(),this.fT=20)}cM(t){let s=2*PI*this.$/30,i=[];for(let t=0;t<2*PI;t+=2*PI/s)i.push(t);this.ak.forEach(t=>U._E(i,t.at)),i.length&&this.ak.push(new t(this,_$(i)))}fO(){U._k.push(new eA(this.B,this.x+C(-1,1),this.y+C(-1,1)))}_e(){V._G(this._z.x,this._z.y,this._N+2*this.$)&&(R.lineWidth=10,R.strokeStyle="rgba(255,255,255,0.1)",beginPath(),arc(this._z.x,this._z.y,this._N,0,2*PI),stroke(),V._G(this.x,this.y,this.$+50)&&(R.strokeStyle="#fff",R.lineWidth=60,this.ec&&M(()=>{R.globalAlpha=.5,translate(this.x,this.y),rotate(PI/4),scale(1,.2),beginPath(),arc(0,0,1.5*this.$,0,PI),stroke()}),this.ak.forEach(t=>M(()=>{translate(t.x,t.y),rotate(t.at+this.A),t._e()})),translate(this.x,this.y),M(()=>{rotate(this.A),drawImage(this._w(),-this._w().width/2,-this._w().height/2)}),M(()=>{rotate(this.bI),drawImage(this.dY(),0,-this.dY().height/2)}),this.ec&&M(()=>{R.globalAlpha=.5,rotate(PI/4),scale(1,.2),beginPath(),arc(0,0,1.5*this.$,-PI,0),stroke()})))}dT(){return this._u+" ("+("#f00"===this.B._Q()?"enemy":"ally")+")"}}class ca{constructor(t,s){this._A=0,this.J=t,this.aZ=s,this.fK=this._Q()}_Q(){return this.aZ<.5?"#f00":"#0f0"}fJ(){return"#f00"===this._Q()?"enemy":"ally"}aF(t){let s=this._Q();this.aZ=_x(0,this.aZ+t,1),this._Q()!==s&&G.dC(this.J._u+" is now your "+this.fJ())}}class dB{constructor(t){this.B=t,this.x=this.y=0,this._r=this._o=0,this.bC=0,this.A=0,this.$=20,this.ac=200,this._m=1,this._T=0}S(t){if(this.x+=this._r*t,this.y+=this._o*t,this.b_&&!this.fE){this._r+=400*cos(this.A)*t,this._o+=400*sin(this.A)*t;for(let s=0;s<ceil(60*t);s++)_C("#fff",[["dW",1,0,1],["hs",C(2,4),C(5,10),1],["x",this.x,this.x+C(-20,20),1],["y",this.y,this.y+C(-20,20),1]])}let s=atan2(this._o,this._r),i=min(max(0,bS(0,0,this._r,this._o)-50*t),500);this._r=i*cos(s),this._o=i*sin(s),this.A+=t*(this.fE||this.bC)*3,G.N-(this.bu||0)>.5&&(this._T-=.5*t),this._T<=0&&(this.bp=0)}_e(){if(!V._G(this.x,this.y,this.$))return;K(1-_x(0,G.N-this.aB,.1)/.1>0?"#f00":this.dq()),translate(this.x,this.y),rotate(this.A),beginPath(),moveTo(-5,0),lineTo(-10,10),lineTo(20,0),lineTo(-10,-10),fill();let t=U.aA.reduce((t,s)=>!t||H(t,this)>H(s,this)?s:t,null);if(t){let s=aT(this.A-_P(this,t));K("#000"),R.globalAlpha=(1-2*abs(abs(s)/PI-.5))*_x(0,1-H(t,this)/5e3,1),beginPath(),moveTo(-5,0),lineTo(-10,10*aR(s)),lineTo(20,0),fill()}}aV(t,s=.1){if(G.N-(this.bu||0)<s||this.bp)return;this.bu=G.N;let i=new t(this,this.x,this.y,this.A);this.dk(i),U.aC.push(i),this._T=min(1,max(this._T,0)+i._T),G.aK.bK(2,i),this._T>=1&&(this.bp=1)}dk(){}_s(t,s){_C("#ff0",[["dW",1,0,1],["hs",C(2,4),C(5,10),1],["x",this.x,this.x+C(-20,20),1],["y",this.y,this.y+C(-20,20),1]]),this.aB=G.N,(this._m-=s)<=.05&&this._Z(t)}_Z(t){this._m=0;for(let t=0;t<100;t++){let t=random()*PI*2,s=C(5,50),i=C(.2,1.5);_C(_$(["#ff0","#f80","#f00"]),[["dW",1,0,i],["hs",C(2,4),C(5,10),i],["x",this.x,this.x+cos(t)*s,i],["y",this.y,this.y+sin(t)*s,i]])}U._E(U._k,this),U._E(U.aL,this),V._G(this.x,this.y)&&ck(),U.cb(this.x,this.y,10)}}class gy extends dB{constructor(t,s){super(new ca,t,s),this.di=0,this.aw=1,this.bP=0}S(t){this.bP+=t,this.b_=w.Y[38],this.bC=w.Y[37]?-1:w.Y[39]?1:0,w.Y[32]&&this.aV(dj),w.Y[13]&&this.bP>1&&this.aV(dm,.5);let s=this.bk();s&&this._s(s,.15*t),G.N-this.dp>5&&(this.aw+=.05*t),this.aw=min(this._m,this.aw),(this.di-=t)<0&&this.fC(),super.S(t),this.b_?this.a_||(this.a_=a_(),this.a_.loop=1):this.a_&&(this.a_.pause(),this.a_=null)}fC(){let t=min(1-this._m,.1),s=~~(10*t/.1);this.B._A>=s&&t>0&&G.fD(()=>{this._m+=t,this.B._A-=s}),this.di=1}_s(t,s){let i=t instanceof eH;if(this.aw>0)return this.aw-=s,void((!i||G.N-(this.dp||0)>.3)&&(this.dp=G.N,this.fF=_P(this,t),_f(this,"hY",.8,1,.2)));i||V.fG(.1),super._s(t,s),this.di=5}dk(t){t.dG=100}dq(){return"#fff"}_Z(t){super._Z(t),setTimeout(()=>G.fL(),2e3),this.a_&&this.a_.pause()}_D(){return this._m<=.3?"CRITICAL HULL DAMAGE"+(this.B._A<10?". FIND RESOURCES TO REPAIR":""):this.bk()?"CRITICAL HEAT":U.aL.filter(t=>H(t,this)<1e3).length?"PIRATES NEARBY":this.aw<=0?"SHIELDS OFFLINE":void 0}bk(){return U.aA.filter(t=>H(this,t)<2*t.$)[0]}_e(){M(()=>super._e()),translate(this.x,this.y),rotate(this.fF),K("#fff"),beginPath(),arc(0,0,25,-PI/2,PI/2),M(()=>{scale(this.hY,1),arc(0,0,25,PI/2,-PI/2,1)}),fill()}}class eA extends dB{constructor(t,s,i){super(t),this.dM=0,this.x=s,this.y=i}dq(){return this.B._Q()}dO(){return this.ah?H(this,this.ah)>400&&H(this.B.J,this.ah)>2*this.B.J.$?0:H(this.B.J,this.ah)<this.B.J.$?0:1:0}fS(){return this.dO()?this.ah:this.P}fW(){this.bC=0,this.b_=0;let t=this.fS();if(!t)return;let s=bS(0,0,this._r,this._o),i=_P(this,t),h=aT(i-this.A);if(abs(h)>PI/64&&(this.bC=aR(h)),abs(h)<PI/64){let i=atan2(this._o,this._r),h=s/50,e=-50*h*h/2+s*h,a={x:this.x+e*cos(i),y:this.y+e*sin(i)},r=H(a,t);this.b_=r>50}this.dO()&&abs(h)>PI/64&&!this.bp&&(this._T+=.05,this.aV(dj)),s>250&&(this.b_=0)}S(t){if(!V._G(this.x,this.y,500))return;this.ah="#f00"===this.B._Q()?U.D:null,(!this.P||H(this,this.P)<this.g$||H(this.B.J,this.P)<this.B.J.$||(this.dM-=t)<=0)&&this.g_(),this.fW(),super.S(t);let s=_P(this.B.J,this),i=max(H(this,this.B.J),this.B.J.$+2*this.$);this.x=this.B.J.x+cos(s)*i,this.y=this.B.J.y+sin(s)*i}g_(){let t=ga(this.B.J,[this.B.J.$+150,this.B.J.$+250]),s=s=>t.slice().sort((t,i)=>H(t,s)-H(i,s))[0],i=s(this),h=U.ah?s(U.ah):_$(i.ba),e=i.ba.concat([i]).reduce((t,s)=>!t||H(s,h)<H(t,h)?s:t,null);this.g$=50,this.P=H(this,e)>H(this,h)?h:e,this.dM=2}_s(t,s){super._s(t,s),t._K===U.D&&this.B.aF(-.05)}_Z(t){super._Z(t),t._K===U.D&&this.B.aF(-.3)}}class cp{constructor(t,s){this.I=t,this.at=s,this.$=15,this.scale=1,this.aB=0,this._m=1}get bm(){return this.at+this.I.A}S(){this.x=this.I.x+(this.I.$-2)*cos(this.bm),this.y=this.I.y+(this.I.$-2)*sin(this.bm)}_e(){let t=1-_x(0,G.N-this.aB,.1)/.1;scale(1+.2*t,1+.2*t),K(t>0?"#fff":this.I.B._Q()),this.aY()}_s(t,s){t._K==U.D&&(_C("#ff0",[["dW",1,0,1],["hs",C(2,4),C(5,10),1],["x",this.x,this.x+C(-20,20),1],["y",this.y,this.y+C(-20,20),1]]),this.aB=G.N,this.I.B.aF(-.05),(this._m-=s)<=0&&this._Z(t))}_Z(t){for(let t=0;t<50;t++){let t=this.bm+C(-PI/2,PI/2),s=C(30,50);_C(_$(["#ff0","#f80","#f00"]),[["dW",1,0,1],["hs",C(2,4),C(5,10),1],["x",this.x,this.x+cos(t)*s,1],["y",this.y,this.y+sin(t)*s,1]])}U._E(this.I.ak,this),t==U.D&&this.I.B.aF(-.2),G.aK.bK(0,this),U.cb(this.x,this.y,10)}}class fR extends cp{aY(){fr(0,-11,10,6),fr(0,-3,20,6),fr(0,5,6,6)}}class fQ extends cp{constructor(t,s){super(t,s),this.aW=0}aY(){beginPath(),arc(0,0,10,0,2*PI),fill(),rotate(this.aW),fr(0,-2,20,4)}S(t){super.S(t);let s=aT(_P(this,U.D)-this.bm),i=_x(-PI/4,s,PI/4),h=t*PI/4;this.aW+=_x(-h,i-this.aW,h),H(this,U.D)<500&&abs(aT(this.aW-s))<PI/64&&"#f00"===this.I.B._Q()&&this.aV()}aV(){if(G.N-(this.bu||0)<2)return;this.bu=G.N;let t=this.bm+this.aW;U.aC.push(new dm(this,this.x+cos(t)*(this.$+15),this.y+sin(t)*(this.$+15),t))}}class fP extends cp{aY(){beginPath(),moveTo(0,-10),lineTo(10,-10),lineTo(7,-2),lineTo(10,-2),lineTo(7,6),lineTo(18,6),lineTo(18,9),lineTo(0,9),fill()}}class gc{constructor(t,s){this.gd=random(),this.ce=10,_f(this,"x",t,t+C(-50,50),.3),_f(this,"y",s,s+C(-50,50),.3)}S(t){if(U.D._m<=0)return;let s=H(this,U.D);if(s<80){let i=_P(this,U.D);this.x+=cos(i)*min(s,200*t),this.y+=sin(i)*min(s,200*t)}s<10&&(U._E(U.aN,this),this.gf(U.D)),(this.ce-=t)<=0&&U._E(U.aN,this)}_e(){!V._G(this.x,this.y)||this.ce<3&&this.ce%.25<.125||(translate(this.x,this.y),scale(sin(this.gd+2*PI*G.N),1),this.aY())}}class ge extends gc{aY(){scale(.3,.3),K("#fff"),eM()}gf(t){t.B._A=min(200,t.B._A+1),G.aK.bK(3,this),G.gg(),gj()}}class eI{constructor(t,s,i,h){this._K=t,this.x=s,this.y=i,this.A=h,this.dG=0,this.bP=0,gl()}S(t){this.x+=cos(this.A)*this._Y*t,this.y+=sin(this.A)*this._Y*t,(!V._G(this.x,this.y)||(this.bP+=t)>=2)&&U._E(U.aC,this),U.gn(s=>{if(s!==this._K&&(H(s,this)<s.$+this.$&&(U._E(U.aC,this),s._s(this,this._s),gs()),H(s,this)<this.dG)){let i=_P(this,s),h=aT(i-this.A);if(abs(h)<PI/4){let s=_x(-t*PI/2,h,t*PI/2);this.A+=s}}})}}class dj extends eI{constructor(t,s,i,h){super(t,s,i,h),this._Y=400,this.$=4,this._s=.1,this._T=.05}S(t){super.S(t);_C("cyan",[["dW",1,0,.3],["hs",4,C(4,6),.3],["x",this.x,this.x+C(-3,3),.3],["y",this.y,this.y+C(-3,3),.3]])}_e(){translate(this.x,this.y),rotate(this.A),K("cyan"),fr(0,-2,8,4)}}class dm extends eI{constructor(t,s,i,h){super(t,s,i,h),this._Y=800,this.N=0,this.$=15,this._s=.5,this._T=.5}S(t){super.S(t);let s=0*sin((this.N+=t)*PI*2*4);_C("red",[["dW",1,0,.5],["hs",16,C(16,32),.5],["x",this.x+cos(this.A+PI/2)*s*10,this.x+cos(this.A+PI/2)*s*10+C(-16,16),.5],["y",this.y+sin(this.A+PI/2)*s*10,this.y+sin(this.A+PI/2)*s*10+C(-16,16),.5]])}_e(){translate(this.x,this.y),rotate(this.A),K("red"),fr(-5,-5,10,10)}}onresize=(()=>{var t,s,i=innerWidth,h=innerHeight,e=i/h,a=1e3/__,r=document.querySelector("#cc").style;e<=a?s=(t=i)/a:t=(s=h)*a,r.width=t+"px",r.height=s+"px"}),gx=((t,s,i,h)=>t/h*i+s),_f=((t,s,i,h,e,a,r,_)=>{var l={o:t,p:s,a:i,b:h,d:e,l:a||0,f:r||gx,e:_||(()=>0),t:0,S:t=>{if(l.l>0)l.l-=t,l.o[l.p]=l.a;else if(l.t=min(l.d,l.t+t),l.o[l.p]=l.f(l.t,l.a,l.b-l.a,l.d),l.t==l.d){l.e();let t=bX.indexOf(l);t>=0&&bX.splice(t,1)}}};bX.push(l)}),bX=[];let fb="BCDFGHJKLMNPQRSTVWXZ".split(""),ff="AEIOUY".split("");function gC(){this.gE=function(t){for(var s=0;s<24;s++)this[String.fromCharCode(97+s)]=t[s]||0;this.c<.01&&(this.c=.01);var i=this.b+this.c+this.e;if(i<.18){var h=.18/i;this.b*=h,this.c*=h,this.e*=h}}}function gG(){var t,s,i,h,e,a,r,_,l,n,o,c;this.bH=new gC,this.dE=function(){var t=this.bH;h=100/(t.f*t.f+.001),e=100/(t.g*t.g+.001),a=1-t.h*t.h*t.h*.01,r=-t.i*t.i*t.i*1e-6,t.a||(o=.5-t.n/2,c=5e-5*-t.o),_=1+t.l*t.l*(t.l>0?-.9:10),l=0,n=1==t.m?0:(1-t.m)*(1-t.m)*2e4+32},this.gK=function(){this.dE();var h=this.bH;return t=h.b*h.b*1e5,s=h.c*h.c*1e5,i=h.e*h.e*1e5+12,3*((t+s+i)/3|0)},this.gM=function(f,d){var G=this.bH,g=1!=G.s||G.v,u=G.v*G.v*.1,b=1+3e-4*G.w,y=G.s*G.s*G.s*.1,p=1+1e-4*G.t,x=1!=G.s,w=G.x*G.x,I=G.g,m=G.q||G.r,P=G.r*G.r*G.r*.2,U=G.q*G.q*(G.q<0?-1020:1020),$=G.p?32+((1-G.p)*(1-G.p)*2e4|0):0,R=G.d,B=G.j/2,A=G.k*G.k*.01,T=G.a,S=t,D=1/t,E=1/s,N=1/i,W=5/(1+G.u*G.u*20)*(.01+y);W>.8&&(W=.8),W=1-W;for(var v,H,k,M,V,K,Y=0,q=0,J=0,O=0,L=0,F=0,Z=0,Q=0,X=0,z=0,j=0,tt=new Array(1024),st=new Array(32),it=tt.length;it--;)tt[it]=0;for(it=st.length;it--;)st[it]=C(-1,1);for(it=0;it<d;it++){if(Y)return it;if($&&++z>=$&&(z=0,this.dE()),n&&++l>=n&&(n=0,h*=_),(h*=a+=r)>e&&(h=e,I>0&&(Y=1)),H=h,B>0&&(H*=1+sin(j+=A)*B),(H|=0)<8&&(H=8),T||((o+=c)<0?o=0:o>.5&&(o=.5)),++J>S)switch(J=0,++q){case 1:S=s;break;case 2:S=i}switch(q){case 0:O=J*D;break;case 1:O=1+2*(1-J*E)*R;break;case 2:O=1-J*N;break;case 3:O=0,Y=1}m&&((k=0|(U+=P))<0?k=-k:k>1023&&(k=1023)),g&&b&&((u*=b)<1e-5?u=1e-5:u>.1&&(u=.1)),K=0;for(var ht=8;ht--;){if(++Q>=H&&(Q%=H,3==T))for(var et=st.length;et--;)st[et]=C(-1,1);switch(T){case 0:V=Q/H<o?.5:-.5;break;case 1:V=1-Q/H*2;break;case 2:V=.225*(((V=1.27323954*(M=6.28318531*((M=Q/H)>.5?M-1:M))+.405284735*M*M*(M<0?1:-1))<0?-1:1)*V*V-V)+V;break;case 3:V=st[abs(32*Q/H|0)]}g&&(v=Z,(y*=p)<0?y=0:y>.1&&(y=.1),x?(F+=(V-Z)*y,F*=W):(Z=V,F=0),L+=(Z+=F)-v,V=L*=1-u),m&&(tt[X%1024]=V,V+=tt[(X-k+1024)%1024],X++),K+=V}K*=.125*O*w,f[it]=K>=1?32767:K<=-1?-32768:32767*K|0}return d}}fg=(t=>t._$(fb)+t._$(ff)+t._$(fb.concat(ff))),eq=(t=>fg(t)+fg(t)+" "+t._$(["III","IV","V","VI","VII","IX","X"])),fh=(t=>{for(t+="";t.length<2;)t="0"+t;return t}),cv=(t=>fh(~~(t/60))+":"+fh(~~t%60)),ga=((t,s)=>{let i=[],h=[];return s.forEach(s=>{let e=[];h.push(e);for(let h=0;h<6;h++){let a=2*PI*(h/6),r={x:cos(a)*s+t.x,y:sin(a)*s+t.y,ba:[]};i.push(r),e.push(r)}}),h.forEach((t,s)=>{t.forEach((i,e)=>{let a=t[(e+1)%t.length];i.ba.push(a),a.ba.push(i);let r=h[(s+1)%h.length][e];i.ba.push(r),r.ba.push(i)})}),i}),bt=(t=>{let s=new Uint32Array([imul(t,2246822507),imul(t,3266489909)]),i=()=>{let t=s[0],i=s[1]^t;return s[0]=(t<<26|t>>8)^i^i<<9,s[1]=i<<13|i>>19,(imul(t,2654435771)>>>0)/4294967295};return{_$:t=>t[~~(i()*t.length)],_g:(t,s)=>i()*(s-t)+t,gh:i}}),cI=(t=>{let s;return()=>s=s||t()});var cG=new gG,hf=function(t){cG.bH.gE(t);var s=cG.gK(),i=new Uint8Array(4*((s+1)/2|0)+44),h=2*cG.gM(new Uint16Array(i.buffer,44),s),e=new Uint32Array(i.buffer,0,44);e[0]=1179011410,e[1]=h+36,e[2]=1163280727,e[3]=544501094,e[4]=16,e[5]=65537,e[6]=44100,e[7]=88200,e[8]=1048578,e[9]=1635017060,e[10]=h,h+=44;for(var a=0,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",_="data:audio/wav;base64,";a<h;a+=3){var l=i[a]<<16|i[a+1]<<8|i[a+2];_+=r[l>>18]+r[l>>12&63]+r[l>>6&63]+r[63&l]}var n=new Audio;return n.src=_,n};_U=((t,s=1)=>{let i=0,h=cI(()=>[...Array(s)].map(()=>hf(t)));return()=>{let t=h()[i++%h().length];return t.play(),t}});let ck=_U([3,,.3346,.2953,.4941,.1205,,-.2565,,,,,,,,,-.1093,-.2344,1,,,,,.5]),gl=_U([0,,.1584,.1384,.2216,.63,,-.2653,,,,,,.1485,,,,,1,,,.1888,,.5],10),hl=_U([1,.12,.1,.0079,.32,.83,.0017,,.04,.34,.96,.0056,,,.8422,.0048,,-.0327,1,,,,,.37]),hn=_U([0,,.1696,,.0103,.2617,,,,,,,,.1416,,,,,1,,,.1,,.5]),gj=_U([0,,.0323,.3656,.1925,.4276,,,,,,,,,,,,,1,,,,,.5],10),gs=_U([3,,.0825,,.2264,.3697,,-.5926,,,,,,,,,,,1,,,.0684,,.5],10),a_=_U([3,,1,,,.14,,,,,,,,,,1,,,1,,,.0684,,.2],1),ho=_U([2,1,.01,.0079,1,.23,.0017,.0194,.0078,.81,.41,.0056,,,.8422,.0048,,-.0327,1,,,,,.45]),hp=_U([2,.72,.01,.0079,1,.6,.0017,.0194,.0078,.57,.71,.0056,,,.8422,.0048,,-.0327,1,,,,,.45]),hq=_U([1,.03,.42,.0079,.32,.14,.0017,,.04,,,.0056,,,.8422,.0048,,-.0327,1,,,,,.37]);class hr{constructor(){this._W={}}bK(t,s){(this._W[t]||[]).forEach(t=>t(s))}_p(t,s){this._W[t]=this._W[t]||[],this._W[t].push(s)}hk(t,s){let i=(this._W[t]||[]).indexOf(s);i>=0&&this._W[t].splice(i,1)}}w.Y={},onkeydown=(t=>{w.Y[t.keyCode]=1}),onkeyup=(t=>{w.Y[t.keyCode]=0;let s=String.fromCharCode(t.keyCode).toLowerCase();isNaN(s)&&G.dV(s)}),ontouchstart=(t=>ontouchmove(t,1)),ontouchmove=ontouchend=((t,s)=>{t.preventDefault();let i=document.querySelector("canvas").getBoundingClientRect();w.Y[32]=0,w.Y[37]=0,w.Y[38]=0,w.Y[39]=0;for(let h=0;h<t.touches.length;h++){let e=(t.touches[h].clientX-i.left)/i.width,a=(t.touches[h].clientY-i.top)/i.height;a>1-200/__?e<.25?w.Y[37]=1:e<.5?w.Y[39]=1:e<.75?w.Y[32]=1:w.Y[38]=1:s&&a>1-400/__&&G.dV(~~(e/(1/(G.bB||[]).length)))}dh=1,G.aP()});class hv{constructor(){this.x=this.y=0,this.cQ=this.cR=0,this.ab=this.aM=1}S(t){let s=999;U._a.forEach(t=>{s=min(s,H(t,U.D))}),s>700?this.aM=.5:s<500&&(this.aM=1);let i=this.cL||this.aM;this.ab+=_x(-.5*t,i-this.ab,.5*t),this.width=1e3/this.ab,this.height=__/this.ab,(this.eu-=t)>0&&(this.cQ=C(-10,10),this.cR=C(-10,10)),this.x=U.D.x-this.width/2+this.cQ,this.y=U.D.y-this.height/2+this.cR}_G(t,s,i=0){return t+i>this.x&&s+i>this.y&&t-i<this.x+this.width&&s-i<this.y+this.height}fG(t){this.eu=max(this.eu||0,t)}}class hy{constructor(){G=this,U=new gB,V=new hv,G.eE(),G.N=0,G.aS=_y("everyone's"),G.aI=_y("sky"),G.cS=_y("press enter to send a ship"),G.eF=G.cT=50,G.cU=G.eU=100,G.cV=0,G.cW=1,G.eZ=0,G.cX=1,G.hC=1,G.fa=1,G.d$="#fff"}bs(t){G.O&&G.O.hm(),G.O=t,G.cB=20,G._n(),t&&(t.hh=(t=>G.bs(t)),t.W())}d_(t,s,i,h,e){M(()=>{translate(t,s),K("rgba(128,128,128,0.5)"),fr(0,-5,200,10),K(h),fr(0,-5,-2,10),fr(200,-5,2,10),fr(0,-5,200*_x(0,i,1),10),translate(-25,0),e()})}fD(t){_f(G,"eZ",0,-30,.3,0,0,()=>{G.eZ=0}),_f(G,"fa",1,2,.3,.2,0,()=>{_f(G,"fa",2,1,.3,0,0,()=>{G.d$="#fff"})}),setTimeout(()=>G.d$="#0f0",200),_f(G,"cX",1,0,.3,0,0,()=>{G.cX=1,t()}),_f(G,"hC",1,0,.3,0,0,()=>{_f(G,"hC",0,1,.3,.3)})}gg(){_f(G,"cX",1,2,.3,0,0,()=>{_f(G,"cX",2,1,.3)})}S(t){G.N+=t,G.bn&&((G.cB-=t)<=0&&G.hG(),U.S(t),G.aK.bK(1,t)),bX.slice().forEach(s=>s.S(t)),w.Y[13]&&G.aP(),U._e(),M(()=>{translate(V.cQ,V.cR),K("rgba(0,0,0,0.5)"),R.strokeStyle="#fff",fr(50,30,270,100),strokeRect(50.5,30.5,270,100),G.d_(100,50,U.D._m,U.D._m<.25||G.N-U.D.aB<.2?"#f00":G.d$,()=>{scale(.5*G.fa,.5*G.fa),beginPath(),moveTo(0,-15),lineTo(14,-10),lineTo(10,10),lineTo(0,18),lineTo(-10,10),lineTo(-14,-10),fill()}),M(()=>{R.shadowColor="#0f0",R.shadowBlur=10,K("cyan"),fr(100,45,200*_x(0,U.D.aw,1),10)}),G.d_(100,80,U.D.B._A/200,"#fff",()=>{R.globalAlpha=G.hC,translate(0,G.eZ),scale(.3*G.cX,.3*G.cX),eM()}),G.d_(100,110,U.D._T,U.D.bp?"#f00":"#fff",()=>{fr(-5,-5,3,10),fr(-1,-5,3,10),fr(3,-5,3,10)});let t=[];if(G.O)t=G.O._v||[];else{let s=U.aA.sort((t,s)=>H(t,U.D)-H(s,U.D)).slice(0,3);s[0]&&(H(s[0],U.D)>s[0].ac?t=s:s[0].hH||(s[0].hH=1,G.dC("system discovered - "+s[0]._u)))}t.forEach(t=>{if(H(t,U.D)<(t.ac||0))return;let s=_P(U.D,t);M(()=>{let i=200*_x(0,(H(t,U.D)-t.ac)/4e3,1)+50;translate(500+cos(s)*i,__/2+sin(s)*i),rotate(s),R.globalAlpha=.5,K("#fff"),beginPath(),moveTo(0,0),lineTo(-14,10),lineTo(-8,0),lineTo(-14,-10),fill()})});let s=G.Z();s&&M(()=>{K("rgba(0,0,0,0.5)"),R.font="20pt "+aE,translate(0,__-(dh?400:200)),fr(0,0,1e3,200);let t=measureText(s+"_").width,i=this.dN();K("#fff"),R.textAlign="left",G.bh||fillText(i,(1e3-t)/2,50),i.length>=s.length&&(R.textAlign="center",R.textBaseline="middle",R.font="16pt "+aE,G.bB.forEach((t,s)=>{if(K("#fff"),G.bh){if(G.bh!=t)return;R.globalAlpha=(sin(G.N*PI*2*4)+1)/2}let i="["+t.hN[0]+"]"+t.hN.slice(1),h=(s+1)*(1e3/(G.bB.length+1));fr(h-75,85,150,30),R.globalAlpha=1,K("#000"),fillText(i,h,100)}))});let i=U.D._D();i&&i!=G._D&&(G.hO=G.N+3,G._D=i,hq()),i||(G._D=0),G._D&&G.N<G.hO&&(K("rgba(255,0,0,0.5)"),fr(0,200,1e3,125),R.font="36pt "+aE,R.textBaseline="middle",R.textAlign="center",K("#fff"),fillText("/!\\ WARNING /!\\",500,250),R.font="18pt "+aE,fillText(G._D,500,300),G._S=0),R.strokeStyle="#fff",R.lineCap="round",G._S&&G.hP&&M(()=>{R.lineWidth=4;let t=20*G._S.width;translate((1e3-t)/2,(__-100)/2-200),be(G._S,20,30,G.hP,.1,1)}),M(()=>{translate(0,G.fq),K("#000"),fr(0,0,1e3,__),R.lineWidth=8;let t=(__-G.cU*(G.aS.height+.4+G.aI.height))/2;M(()=>{translate((1e3-G.aS.width*G.eF)/2,t),be(G.aS,G.eF,G.cU,G.N-.5,.1,1)}),M(()=>{R.lineWidth=G.hS,translate((1e3-G.aI.width*G.cT)/2,t+G.cU*G.aI.height*7/5),be(G.aI,G.cT,G.eU,G.N-.5,G.aS.ay.length/G.aI.ay.length*.1,1)}),R.lineWidth=4;M(()=>{G.N%1>.5&&G.N>6||G.fq||(translate((1e3-20*G.cS.width)/2,__-30-100),be(G.cS,20,30,G.N-5,.01,.2))}),R.font="20pt Mono",K("#fff"),R.textAlign="center",G.dU.forEach((t,s)=>{fillText(t,500,3*__/4-50+30*s)})})}),M(()=>{dh&&(translate(0,__-200),R.globalAlpha=.8,K("#000"),fr(0,0,1e3,200),K("#fff"),translate(0,100),M(()=>{R.globalAlpha=w.Y[37]?1:.5,translate(125,0),rotate(PI),G.de()}),M(()=>{R.globalAlpha=w.Y[39]?1:.5,translate(375,0),G.de()}),M(()=>{R.globalAlpha=w.Y[32]?1:.5,translate(625,0),beginPath(),moveTo(0,0),arc(0,0,40,0,2*PI),fill()}),M(()=>{R.globalAlpha=w.Y[38]?1:.5,translate(875,0),rotate(-PI/2),G.de()}))})}de(){beginPath(),moveTo(40,0),lineTo(-40,-40),lineTo(-40,40),fill()}_n(t,s){G.Z=t&&t.call?t:()=>t,G.hV=G.N,G.bB=s||[],G.bh=null,G.Z()&&hl()}dV(t){G.dN().length<(G.Z()||"").length||G.bh||(G.bB||[]).forEach((s,i)=>{i!=t&&s.hN[0].toLowerCase()!==t||(G.bh=s,setTimeout(s.i$,500),hn())})}dC(t){G._S=_y(t),_f(G,"hP",G._S.ay.length,0,.1*G._S.ay.length,3),_f(G,"hP",0,G._S.ay.length,.1*G._S.ay.length),hp()}hG(){let t=U._a.filter(t=>t._z).reduce((t,s)=>!t||H(U.D,s)<H(U.D,t)?s:t,null);if(t&&!G.O){let s=s=>_g(1e3,H(s,t),1e4),i=()=>U._a.filter(t=>t._z).filter(s),h=()=>i().concat(U.aA.filter(s)),e=_$([new hX(_$(i())),new gL(_$(h())),new gJ,new gH,new gD]);e.B=t.B,G.bs(new gX(e));for(let s=0,i=max(t.$,H(U.D,t)-V.width);i<H(U.D,t);s++,i+=50){let h=_P(t,U.D);_C(0,[["dW",1,0,.1,.02*s+.2],["dW",0,1,.1,.02*s]],s=>{R.strokeStyle="#fff",R.lineWidth=2,R.globalAlpha=s.dW,beginPath(),arc(t.x,t.y,i,h-PI/16,h+PI/16),stroke()})}}}bl(t){let s=G.O;G.bs(),s.B.aF(t?.5:-.2),G._n("Mission "+(t?"SUCCESS":"FAILED")+". "+s.B.J._u+" will remember that.",[{hN:"Dismiss",i$:()=>G._n()}])}aP(){!G.bn&&G.cW&&(U.fe(),_f(G,"fq",0,-__,.3),G.cV||(V.ab=V.cL=1,setTimeout(()=>G.bs(new hg),3e3)),G.cB=G.cV?20:9,G.bn=G.cV=1,ho())}fL(){let t,s=U._a.filter(t=>t.B&&t.B._Q()!=t.B.fK).map(t=>t.B),i=s.filter(t=>"#f00"==t._Q()).length,h=s.filter(t=>"#0f0"==t._Q()).length;t=i+h<10?"you were barely noticed":abs(i-h)<5?"little has changed":i>h?"you brought war":"you brought peace",G.aS=_y("game over"),G.aI=_y(t),G.cS=_y("press enter to send another ship"),G.cT=25,G.eU=50,G.hS=6,G.cW=G.bn=0,G.N=0,_f(G,"fq",-__,0,.3,0,0,()=>G.eE()),setTimeout(()=>{G.dU=[i+" planets have declared war against you",h+" species are now your allies"],G.cW=1},4e3)}eE(){G.aK=new hr,G.Z=(()=>0),G.bn=0,G.fq=0,G.O=0,G._D=0,G.dU=[]}dN(){let t=G.Z()||"",s=~~min(20*(G.N-G.hV),t.length);return t.slice(0,s)+(s<t.length||G.N%1>.5?"_":"")}}onload=(()=>{onresize();let t=document.querySelector("canvas");t.width=1e3,t.height=__,R=t.getContext("2d"),Object.getOwnPropertyNames(p).forEach(t=>{R[t]&&R[t].call&&(w[t]=p[t].bind(R))}),R.font="99pt f";let s=measureText(w.title);for(let t of["Mono","Courier"]){R.font="99pt "+t;let i=measureText(w.title);if(i.width!=s.width||i.height!=s.height){aE=t;break}}new hy;let i=Date.now(),h=()=>{let t=Date.now(),s=(t-i)/1e3;i=t,G.S(s),requestAnimationFrame(h)};h()});</script></body></html>
