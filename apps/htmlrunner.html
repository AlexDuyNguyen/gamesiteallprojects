<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Code Runner Pro</title>
  <style>
    :root {
      --primary-color: #6366f1;
      --primary-hover: #4f46e5;
      --bg-color: #f8fafc;
      --border-color: #e2e8f0;
      --header-bg: #1e293b;
      --text-color: #334155;
      --text-light: #64748b;
      --text-dark: #0f172a;
      --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
      --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
    }
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
    }

    body {
      background-color: var(--bg-color);
      color: var(--text-color);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    .header {
      background-color: var(--header-bg);
      color: white;
      padding: 1rem 1.5rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
      box-shadow: var(--shadow);
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }

    .logo h1 {
      font-size: 1.25rem;
      font-weight: 600;
    }

    .logo-icon {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 32px;
      height: 32px;
      background-color: var(--primary-color);
      border-radius: 6px;
      color: white;
      font-weight: bold;
    }

    .main-container {
      flex: 1;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1rem;
      padding: 1rem;
      max-width: 1440px;
      margin: 0 auto;
      width: 100%;
      transition: all 0.3s ease;
    }

    .panel {
      display: flex;
      flex-direction: column;
      background-color: white;
      border-radius: 0.5rem;
      overflow: hidden;
      box-shadow: var(--shadow);
      height: calc(100vh - 120px);
    }

    .panel-header {
      background-color: #f1f5f9;
      border-bottom: 1px solid var(--border-color);
      padding: 0.75rem 1rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .panel-title {
      font-size: 0.875rem;
      font-weight: 600;
      color: var(--text-dark);
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .panel-content {
      flex: 1;
      overflow: hidden;
      position: relative;
    }

    #htmlInput {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      padding: 1rem;
      font-family: 'Menlo', 'Monaco', 'Courier New', monospace;
      font-size: 0.95rem;
      line-height: 1.6;
      border: none;
      resize: none;
      outline: none;
      color: var(--text-dark);
    }

    #iframe-container {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: white;
      transition: all 0.3s ease;
    }

    iframe {
      width: 100%;
      height: 100%;
      border: none;
    }

    .toolbar {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .btn {
      background-color: var(--primary-color);
      color: white;
      border: none;
      padding: 0.5rem 1rem;
      border-radius: 0.375rem;
      font-size: 0.875rem;
      font-weight: 500;
      cursor: pointer;
      transition: background-color 0.2s;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .btn:hover {
      background-color: var(--primary-hover);
    }

    .btn-outline {
      background-color: transparent;
      border: 1px solid var(--border-color);
      color: var(--text-light);
    }

    .btn-outline:hover {
      background-color: #f1f5f9;
    }

    .btn-sm {
      padding: 0.375rem 0.625rem;
      font-size: 0.75rem;
    }

    .select-wrapper {
      position: relative;
      background-color: transparent;
      border: 1px solid var(--border-color);
      border-radius: 0.375rem;
      font-size: 0.75rem;
      color: var(--text-light);
      transition: all 0.2s;
    }

    .select-wrapper:hover {
      background-color: #f1f5f9;
    }

    #viewportSize {
      appearance: none;
      background: transparent;
      border: none;
      padding: 0.375rem 1.5rem 0.375rem 0.625rem;
      font-size: 0.75rem;
      color: var(--text-light);
      cursor: pointer;
      outline: none;
      width: 100%;
    }

    .select-wrapper::after {
      content: "▼";
      font-size: 0.5rem;
      position: absolute;
      right: 0.5rem;
      top: 50%;
      transform: translateY(-50%);
      pointer-events: none;
    }

    .footer {
      padding: 1rem;
      font-size: 0.75rem;
      color: var(--text-light);
      text-align: center;
      border-top: 1px solid var(--border-color);
      background-color: white;
    }

    .tabs {
      display: flex;
      background-color: #f1f5f9;
      border-bottom: 1px solid var(--border-color);
    }

    .tab {
      padding: 0.5rem 1rem;
      font-size: 0.75rem;
      cursor: pointer;
      color: var(--text-light);
      border-bottom: 2px solid transparent;
    }

    .tab.active {
      color: var(--primary-color);
      border-bottom: 2px solid var(--primary-color);
      font-weight: 500;
    }

    .notification {
      position: fixed;
      bottom: 1rem;
      left: 50%;
      transform: translateX(-50%);
      padding: 0.75rem 1rem;
      background-color: #10b981;
      color: white;
      border-radius: 0.375rem;
      font-size: 0.875rem;
      box-shadow: var(--shadow);
      opacity: 0;
      transition: opacity 0.3s ease;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .notification.show {
      opacity: 1;
    }

    #resizer {
      position: absolute;
      top: 0;
      bottom: 0;
      left: 50%;
      width: 6px;
      background-color: transparent;
      cursor: col-resize;
      z-index: 10;
      transform: translateX(-3px);
    }

    #resizer:hover, #resizer.active {
      background-color: var(--primary-color);
    }

    /* Responsive */
    @media (max-width: 768px) {
      .main-container {
        grid-template-columns: 1fr;
      }
    }

    /* Dark mode toggle */
    .dark-mode-toggle {
      background: none;
      border: none;
      color: white;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      width: 32px;
      height: 32px;
      border-radius: 0.375rem;
      transition: background-color 0.2s;
    }

    .dark-mode-toggle:hover {
      background-color: rgba(255, 255, 255, 0.1);
    }

    /* Icons */
    .icon {
      width: 1em;
      height: 1em;
      stroke-width: 2;
      stroke: currentColor;
      fill: none;
      stroke-linecap: round;
      stroke-linejoin: round;
    }
  </style>
</head>
<body>
  <div class="header">
    <div class="logo">
      <div class="logo-icon">CR</div>
      <h1>Code Runner Pro</h1>
    </div>
    <div class="toolbar">
      <button class="btn" onclick="runHtml()" title="Run Code">
        <svg class="icon" viewBox="0 0 24 24"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>
        Run
      </button>
      <button class="btn btn-outline" onclick="resetHtml()" title="Reset Code">
        <svg class="icon" viewBox="0 0 24 24"><path d="M3 2v6h6"></path><path d="M3 13a9 9 0 1 0 3-7.7L3 8"></path></svg>
        Reset
      </button>
      <button class="btn btn-outline" onclick="openInAboutBlank()" title="Open in New Window">
        <svg class="icon" viewBox="0 0 24 24"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg>
        Open in New Window
      </button>
      <button class="dark-mode-toggle" onclick="toggleDarkMode()" title="Toggle Dark Mode">
        <svg class="icon" viewBox="0 0 24 24"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>
      </button>
    </div>
  </div>

  <div class="main-container">
    <div class="panel" id="editorPanel">
      <div class="panel-header">
        <div class="panel-title">
          <svg class="icon" viewBox="0 0 24 24"><path d="M16 18l6-6-6-6"></path><path d="M8 6l-6 6 6 6"></path></svg>
          Editor
        </div>
        <div class="toolbar">
          <button class="btn btn-sm btn-outline" onclick="copyCode()" title="Copy Code">
            <svg class="icon" viewBox="0 0 24 24"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
            Copy
          </button>
          <button class="btn btn-sm btn-outline" onclick="toggleFullscreen()" title="Toggle Fullscreen">
            <svg class="icon" id="fullscreenIcon" viewBox="0 0 24 24"><path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"></path></svg>
          </button>
        </div>
      </div>
      <div class="tabs">
        <div class="tab active" onclick="switchTab('html')">HTML</div>
        <div class="tab" onclick="switchTab('css')">CSS</div>
        <div class="tab" onclick="switchTab('js')">JavaScript</div>
      </div>
      <div class="panel-content">
        <textarea id="htmlInput" spellcheck="false"><!DOCTYPE html>
<html>
<head>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
      line-height: 1.6;
    }
    h1 {
      color: #6366f1;
    }
  </style>
</head>
<body>
  <h1>Hello World!</h1>
  <p>Edit this HTML and click "Run" to see your changes.</p>
  <script>
    // You can add JavaScript here
    document.querySelector('h1').addEventListener('click', function() {
      alert('You clicked the heading!');
    });
  </script>
</body>
</html></textarea>
      </div>
    </div>

    <div id="resizer"></div>

    <div class="panel" id="previewPanel">
      <div class="panel-header">
        <div class="panel-title">
          <svg class="icon" viewBox="0 0 24 24"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle></svg>
          Preview
        </div>
        <div class="toolbar">
          <button class="btn btn-sm btn-outline" onclick="refreshPreview()" title="Refresh Preview">
            <svg class="icon" viewBox="0 0 24 24"><path d="M23 4v6h-6"></path><path d="M1 20v-6h6"></path><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10"></path><path d="M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path></svg>
            Refresh
          </button>
          <div class="select-wrapper">
            <select id="viewportSize" onchange="changeViewport()">
              <option value="desktop">Desktop</option>
              <option value="tablet">Tablet (768px)</option>
              <option value="mobile">Mobile (375px)</option>
            </select>
          </div>
        </div>
      </div>
      <div class="panel-content">
        <div id="iframe-container">
          <iframe id="outputFrame"></iframe>
        </div>
      </div>
    </div>
  </div>

  <div class="notification" id="notification">
    <svg class="icon" viewBox="0 0 24 24"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>
    <span id="notification-text">Copied to clipboard!</span>
  </div>

  <div class="footer">
    Code Runner Pro • Built with HTML, CSS, and JavaScript • Use responsibly
  </div>

  <script>
    // Store the original code
    const defaultCode = document.getElementById("htmlInput").value;
    let isDarkMode = false;
    let isResizing = false;
    let activeTab = 'html';
    let finalCode = ''; // Store the final combined code globally
    
    // Code data structure to handle multiple tabs
    const codeData = {
      html: defaultCode,
      css: '/* Add your CSS here */\n\nbody {\n  font-family: Arial, sans-serif;\n  max-width: 800px;\n  margin: 0 auto;\n  padding: 20px;\n  line-height: 1.6;\n}\n\nh1 {\n  color: #6366f1;\n}\n\n.highlight {\n  background-color: #ffffcc;\n  padding: 10px;\n  border-radius: 4px;\n}',
      js: '// Add your JavaScript here\n\ndocument.querySelector(\'h1\').addEventListener(\'click\', function() {\n  alert(\'You clicked the heading!\');\n});'
    };
    
    // Initialize the resizer functionality
    document.getElementById('resizer').addEventListener('mousedown', function(e) {
      isResizing = true;
      document.body.style.cursor = 'col-resize';
      document.getElementById('resizer').classList.add('active');
      
      document.addEventListener('mousemove', handleMouseMove);
      document.addEventListener('mouseup', function() {
        isResizing = false;
        document.body.style.cursor = 'default';
        document.getElementById('resizer').classList.remove('active');
        document.removeEventListener('mousemove', handleMouseMove);
      }, { once: true });
    });
    
    function handleMouseMove(e) {
      if (!isResizing) return;
      
      const container = document.querySelector('.main-container');
      const containerRect = container.getBoundingClientRect();
      const percentage = ((e.clientX - containerRect.left) / containerRect.width) * 100;
      
      // Limit the size to reasonable bounds
      if (percentage > 20 && percentage < 80) {
        container.style.gridTemplateColumns = `${percentage}% ${100 - percentage}%`;
      }
    }
    
    function runHtml() {
      // Combine code from different tabs into a complete HTML document
      finalCode = '';
      
      // Extract the HTML structure
      const parser = new DOMParser();
      const htmlDoc = parser.parseFromString(codeData.html, 'text/html');
      
      // Update or add CSS
      let styleElement = htmlDoc.querySelector('style');
      if (!styleElement && codeData.css.trim()) {
        styleElement = htmlDoc.createElement('style');
        htmlDoc.head.appendChild(styleElement);
      }
      if (styleElement) {
        styleElement.textContent = codeData.css;
      }
      
      // Update or add JavaScript
      let scriptElement = htmlDoc.querySelector('script');
      if (!scriptElement && codeData.js.trim()) {
        scriptElement = htmlDoc.createElement('script');
        htmlDoc.body.appendChild(scriptElement);
      }
      if (scriptElement) {
        scriptElement.textContent = codeData.js;
      }
      
      // Get the final HTML string
      finalCode = new XMLSerializer().serializeToString(htmlDoc);
      
      // Update the iframe
      const iframe = document.getElementById("outputFrame");
      iframe.srcdoc = finalCode;
      
      // Show a notification
      showNotification('Code executed successfully!');
    }
    
    function openInAboutBlank() {
      // Make sure we have the latest code
      if (activeTab) {
        codeData[activeTab] = document.getElementById('htmlInput').value;
        runHtml(); // This updates finalCode
      }
      
      // Open a new window with about:blank
      const newWindow = window.open('about:blank', '_blank');
      
      if (newWindow) {
        // Write the code to the new window
        newWindow.document.open();
        newWindow.document.write(finalCode);
        newWindow.document.close();
        
        // Show a notification
        showNotification('Opened in new window!');
      } else {
        // If popup was blocked
        showNotification('Popup blocked! Please allow popups for this site.', 'error');
      }
    }
    
    function resetHtml() {
      codeData.html = defaultCode;
      // Reset CSS and JS to their defaults too
      codeData.css = '/* Add your CSS here */\n\nbody {\n  font-family: Arial, sans-serif;\n  max-width: 800px;\n  margin: 0 auto;\n  padding: 20px;\n  line-height: 1.6;\n}\n\nh1 {\n  color: #6366f1;\n}\n\n.highlight {\n  background-color: #ffffcc;\n  padding: 10px;\n  border-radius: 4px;\n}';
      codeData.js = '// Add your JavaScript here\n\ndocument.querySelector(\'h1\').addEventListener(\'click\', function() {\n  alert(\'You clicked the heading!\');\n});';
      
      // Update the current tab view
      document.getElementById("htmlInput").value = codeData[activeTab];
      
      // Run the HTML
      runHtml();
      
      // Show a notification
      showNotification('Code has been reset!');
    }
    
    function refreshPreview() {
      runHtml();
    }
    
    function copyCode() {
      const textarea = document.getElementById("htmlInput");
      textarea.select();
      document.execCommand("copy");
      
      // Show notification
      showNotification('Copied to clipboard!');
    }
    
    function showNotification(message, type = 'success') {
      const notification = document.getElementById('notification');
      const notificationText = document.getElementById('notification-text');
      
      // Change color based on type
      if (type === 'error') {
        notification.style.backgroundColor = '#ef4444';
      } else {
        notification.style.backgroundColor = '#10b981';
      }
      
      notificationText.textContent = message;
      notification.classList.add('show');
      
      setTimeout(() => {
        notification.classList.remove('show');
      }, 2000);
    }
    
    function toggleFullscreen() {
      const mainContainer = document.querySelector('.main-container');
      const isFullscreen = mainContainer.style.gridTemplateColumns === "1fr 0fr";
      const fullscreenIcon = document.getElementById('fullscreenIcon');
      
      if (isFullscreen) {
        mainContainer.style.gridTemplateColumns = "1fr 1fr";
        document.getElementById('previewPanel').style.display = 'flex';
        document.getElementById('resizer').style.display = 'block';
        fullscreenIcon.innerHTML = '<path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"></path>';
      } else {
        mainContainer.style.gridTemplateColumns = "1fr 0fr";
        document.getElementById('previewPanel').style.display = 'none';
        document.getElementById('resizer').style.display = 'none';
        fullscreenIcon.innerHTML = '<path d="M4 14h6m0 0v6m0-6l-7 7m17-11h-6m0 0V4m0 6l7-7"></path>';
      }
    }
    
    function changeViewport() {
      const size = document.getElementById("viewportSize").value;
      const iframe = document.getElementById("iframe-container");
      
      if (size === "mobile") {
        iframe.style.maxWidth = "375px";
        iframe.style.margin = "0 auto";
        iframe.style.border = "10px solid #334155";
        iframe.style.borderRadius = "16px";
        iframe.style.height = "calc(100% - 20px)";
      } else if (size === "tablet") {
        iframe.style.maxWidth = "768px";
        iframe.style.margin = "0 auto";
        iframe.style.border = "10px solid #334155";
        iframe.style.borderRadius = "8px";
        iframe.style.height = "calc(100% - 20px)";
      } else {
        iframe.style.maxWidth = "100%";
        iframe.style.margin = "0";
        iframe.style.border = "none";
        iframe.style.borderRadius = "0";
        iframe.style.height = "100%";
      }
    }
    
    function switchTab(tab) {
      // Save current tab content
      codeData[activeTab] = document.getElementById('htmlInput').value;
      
      // Update active tab
      activeTab = tab;
      
      // Load content for new tab
      document.getElementById('htmlInput').value = codeData[tab];
      
      // Update tab highlighting
      const tabs = document.querySelectorAll('.tab');
      tabs.forEach(t => t.classList.remove('active'));
      document.querySelector(`.tab:nth-child(${tab === 'html' ? 1 : tab === 'css' ? 2 : 3})`).classList.add('active');
    }
    
    function toggleDarkMode() {
      isDarkMode = !isDarkMode;
      const root = document.documentElement;
      
      if (isDarkMode) {
        root.style.setProperty('--bg-color', '#0f172a');
        root.style.setProperty('--header-bg', '#1e293b');
        root.style.setProperty('--text-color', '#cbd5e1');
        root.style.setProperty('--text-light', '#94a3b8');
        root.style.setProperty('--text-dark', '#e2e8f0');
        root.style.setProperty('--border-color', '#334155');
        
        document.querySelectorAll('.panel, .footer').forEach(el => {
          el.style.backgroundColor = '#1e293b';
        });
        
        document.querySelectorAll('.panel-header, .tabs').forEach(el => {
          el.style.backgroundColor = '#0f172a';
        });
        
        document.getElementById('htmlInput').style.backgroundColor = '#1e293b';
        document.getElementById('htmlInput').style.color = '#e2e8f0';
        
        document.querySelector('.dark-mode-toggle svg').innerHTML = '<circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>';
      } else {
        root.style.setProperty('--bg-color', '#f8fafc');
        root.style.setProperty('--header-bg', '#1e293b');
        root.style.setProperty('--text-color', '#334155');
        root.style.setProperty('--text-light', '#64748b');
        root.style.setProperty('--text-dark', '#0f172a');
        root.style.setProperty('--border-color', '#e2e8f0');
        
        document.querySelectorAll('.panel, .footer').forEach(el => {
          el.style.backgroundColor = 'white';
        });
        
        document.querySelectorAll('.panel-header, .tabs').forEach(el => {
          el.style.backgroundColor = '#f1f5f9';
        });
        
        document.getElementById('htmlInput').style.backgroundColor = 'white';
        document.getElementById('htmlInput').style.color = '#0f172a';
        
        document.querySelector('.dark-mode-toggle svg').innerHTML = '<path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>';
      }
    }
    
    // Run the HTML on page load
    window.onload = function() {
      runHtml();
    }
  </script>
</body>
</html>
